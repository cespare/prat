Taken from hg rev 33:f0a629bb85a7.
