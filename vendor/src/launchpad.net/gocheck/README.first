Taken from bzr revno 80.
